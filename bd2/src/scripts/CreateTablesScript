DROP TABLE Delivers;
DROP TABLE Delivered_goods;
DROP TABLE Dealers;
DROP TABLE Cells;
DROP TABLE Orders;
DROP TABLE Fee;
DROP TABLE Goods_type;

CREATE TABLE Fee(
    id INTEGER PRIMARY KEY,
    country VARCHAR(100) NOT NULL UNIQUE,
    percent INTEGER NOT NULL CHECK(percent > 0)
);

CREATE TABLE Dealers(
    id INTEGER PRIMARY KEY,
    fee_id INTEGER NOT NULL,
    type VARCHAR(100) NOT NULL,
    CONSTRAINT dealers_fee_fk FOREIGN KEY (fee_id) REFERENCES Fee(id)
);

CREATE TABLE Goods_type(
    id INTEGER PRIMARY KEY,
    type VARCHAR(100) NOT NULL UNIQUE,
    good_size INTEGER NOT NULL CHECK(good_size > 0)
);

CREATE TABLE Delivered_goods(
    id INTEGER PRIMARY KEY,
    dealer_id INTEGER NOT NULL,
    goods_type_id INTEGER NOT NULL,
    cost INTEGER NOT NULL CHECK(cost > 0),
    CONSTRAINT delivered_dealers_fk FOREIGN KEY (dealer_id) REFERENCES Dealers(id),
    CONSTRAINT delivered_goods_type_fk FOREIGN KEY (goods_type_id) REFERENCES Goods_type(id)
);

CREATE TABLE Delivers(
    id INTEGER PRIMARY KEY,
    delivered_goods_id INTEGER NOT NULL,
    amount INTEGER CHECK(amount > 0),
    deliver_date DATE NOT NULL,
    defective INTEGER CHECK(defective >= 0 AND defective <= 1),
    CONSTRAINT delivers_delivered_goods_fk FOREIGN KEY (delivered_goods_id) REFERENCES Delivered_goods(id)
);

CREATE TABLE Orders(
    id INTEGER PRIMARY KEY,
    goods_type_id INTEGER NOT NULL,
    amount INTEGER CHECK(amount > 0),
    order_date DATE NOT NULL
);

CREATE TABLE Cells(
    id INTEGER PRIMARY KEY,
    goods_type_id INTEGER NOt NULL,
    amount INTEGER CHECK(amount > 0),
    CONSTRAINT cell_goods_type_fk FOREIGN KEY (goods_type_id) REFERENCES Goods_type(id)
);
